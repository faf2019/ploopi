ploopi={};
/*!
 * jQuery viewportOffset - v0.3 - 2/3/2010
 * http://benalman.com/projects/jquery-misc-plugins/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var a=$(window);$.fn.viewportOffset=function(){var b=$(this).offset();return{left:b.left-a.scrollLeft(),top:b.top-a.scrollTop()}}})(jQuery);ploopi.annotations={};ploopi.annotations.tag_timer=null;ploopi.annotations.search="";ploopi.annotations.tag_lastedit="";ploopi.annotations.tag_results=new Array();ploopi.annotations.tag_new_array=new Array();ploopi.annotations.tag_modified=-1;ploopi.annotations.display=function(a){ploopi.xhr.todiv("admin-light.php","ploopi_env="+_PLOOPI_ENV+"&ploopi_op=annotation&id_annotation="+a,"ploopiannotation_"+a)};ploopi.annotations.tag_init=function(a){jQuery("#ploopi_annotationtags_"+a).bind("keyup",function(b){src=b.target;idrecord=src.id.split("_")[2];switch(b.keyCode){case 38:case 40:ploopi.annotations.tag_prevent(b);break;case 9:ploopi.annotations.tag_complete(idrecord);ploopi.annotations.tag_prevent(b);break;case 13:ploopi.annotations.tag_complete(idrecord);ploopi.annotations.tag_prevent(b);break;case 35:case 36:case 39:case 37:break;default:tag_last_array=new Array();ploopi.annotations.tag_new_array=new Array();tag_last_array=ploopi.annotations.tag_lastedit.split(" ");ploopi.annotations.tag_new_array=src.value.split(" ");ploopi.annotations.tag_modified=-1;for(i=0;i<ploopi.annotations.tag_new_array.length;i++){if(ploopi.annotations.tag_new_array[i]!=tag_last_array[i]){if(ploopi.annotations.tag_modified==-1){ploopi.annotations.tag_modified=i}else{ploopi.annotations.tag_modified=-2}}}if(ploopi.annotations.tag_modified>=0){ploopi.annotations.tag_search(idrecord,ploopi.annotations.tag_new_array[ploopi.annotations.tag_modified])}break}})};ploopi.annotations.tag_search=function(b,a){clearTimeout(ploopi.annotations.tag_timer);ploopi.annotations.search=a;ploopi.annotations.tag_timer=setTimeout("ploopi.annotations.tag_searchtimeout('"+b+"')",100)};ploopi.annotations.tag_searchtimeout=function(a){list_tags=ploopi.annotations.search.split(" ");if(list_tags.length>0){ploopi.xhr.tocb("index-quick.php","ploopi_env="+_PLOOPI_ENV+"&ploopi_op=annotation_searchtags&tag="+list_tags[list_tags.length-1],ploopi.annotations.tag_display,a)}};ploopi.annotations.tag_display=function(a,b){if(a!=""){ploopi.annotations.tag_results=new Array();splited_result=a.split("|");tagstoprint="";for(i=0;i<splited_result.length;i++){detail=splited_result[i].split(";");if(tagstoprint!=""){tagstoprint+=" "}if(i==0){tagstoprint+="<b>"}tagstoprint+="<a href=\"javascript:ploopi.annotations.tag_complete('"+b+"',"+i+')">'+detail[0]+"</a> ("+detail[1]+")";if(i==0){tagstoprint+="</b>"}ploopi.annotations.tag_results[i]=detail[0]}$("tagsfound_"+b).innerHTML=tagstoprint}else{$("tagsfound_"+b).innerHTML="";ploopi.annotations.tag_results=new Array()}};ploopi.annotations.tag_prevent=function(a){if(window.event){window.event.returnValue=false}else{a.preventDefault()}};ploopi.annotations.tag_keypress=function(a){a=a||window.event;src=(a.srcElement)?a.srcElement:a.target;console.log(self.tag_lastedit);switch(a.keyCode){case 38:case 40:ploopi.annotations.tag_prevent(a);break;case 9:ploopi.annotations.tag_prevent(a);break;case 13:ploopi.annotations.tag_prevent(a);break;default:ploopi.annotations.tag_lastedit=$(src.id).value;break}};ploopi.annotations.tag_complete=function(b,a){if(!(a>=0)){a=0}if(ploopi.annotations.tag_results[a]){ploopi.annotations.tag_new_array[ploopi.annotations.tag_modified]=ploopi.annotations.tag_results[a];taglist="";for(i=0;i<ploopi.annotations.tag_new_array.length;i++){if(taglist!=""){taglist+=" "}taglist+=ploopi.annotations.tag_new_array[i]}$("ploopi_annotationtags_"+b).value=taglist.replace(/(^\s*)|(\s*$)/g,"")+" ";$("tagsfound_"+b).innerHTML=""}ploopi.annotations.tag_results=new Array()};ploopi.annotations.remove=function(a,b){if(confirm("Êtes vous certain de vouloir supprimer cette annotation ?")){ploopi.xhr.send("index-quick.php","ploopi_env="+_PLOOPI_ENV+"&ploopi_op=annotation_delete&ploopi_annotation_id="+b)}ploopi.annotations.display(a)};ploopi.annotations.validate=function(a){if(ploopi.validatefield("Titre",a.ploopi_annotationtags,"string")){return true}return false};ploopi.calendar={};ploopi.calendar.open=function(a,b){ploopi.popup.show(ploopi.xhr.send("index-light.php","ploopi_env="+_PLOOPI_ENV+"&ploopi_op=calendar_open&selected_date="+jQuery("#"+a)[0].value+"&inputfield_id="+a),192,b,false,"ploopi_popup_calendar",null,null,true)};ploopi.checkpass=function(d,f,a){var b=this;b.initialize=function(h,k,g){b.item=jQuery("#"+h).eq(0);b.hook=jQuery("#"+k).eq(0);b.field_name=b.item.id;b.options={messages:["Non sûr!","Trop court","Très faible","Faible","Moyen","Fort","Très fort"],colors:["#f00","#999","#f00","#c06","#f60","#3c0","#2c0"],scores:[10,15,30,40],common:["password","123456","123","1234","mypass","pass","letmein","azerty","qsdfgh","wxcvbn"],minchar:8};jQuery.extend(b.options,g||{});b.hook.prepend('<div class="password-strength-info" id="'+b.field_name+'_text"></div>');b.hook.prepend('<div class="password-strength-bar" id="'+b.field_name+'_bar" style="margin:5px 0; width: 0px;"></div>');b.bar=jQuery("#"+b.field_name+"_bar").eq(0);b.feedback_text=jQuery("#"+b.field_name+"_text").eq(0);b.item.on("keyup",function(){b.checkUserPasswordStrength()})};b.checkUserPasswordStrength=function(h){var g=b.options;var k=b.item[0].value;var h=b.field_name;strength=b.getPasswordScore(k,g);if(strength==-200){b.displayPasswordStrengthFeedback(0,0)}else{if(strength<0&&strength>-199){b.displayPasswordStrengthFeedback(1,10)}else{if(strength<=g.scores[0]){b.displayPasswordStrengthFeedback(2,10)}else{if(strength>g.scores[0]&&strength<=g.scores[1]){b.displayPasswordStrengthFeedback(3,25)}else{if(strength>g.scores[1]&&strength<=g.scores[2]){b.displayPasswordStrengthFeedback(4,55)}else{if(strength>g.scores[2]&&strength<=g.scores[3]){b.displayPasswordStrengthFeedback(5,80)}else{b.displayPasswordStrengthFeedback(6,98)}}}}}}};b.displayPasswordStrengthFeedback=function(h,g){b.feedback_text[0].innerHTML="<span style='color: "+b.options.colors[h]+";'>"+b.options.messages[h]+"</span>";b.bar.css("width",g+"%");b.bar.css("background-color",b.options.colors[h]);b.bar.css("height","8px")};b.getPasswordScore=function(k,g){var l=0;if(k.length<g.minchar){l=(l-100)}else{if(k.length>=g.minchar&&k.length<=(g.minchar+2)){l=(l+6)}else{if(k.length>=(g.minchar+3)&&k.length<=(g.minchar+4)){l=(l+12)}else{if(k.length>=(g.minchar+5)){l=(l+18)}}}}if(k.match(/[a-z]/)){l=(l+1)}if(k.match(/[A-Z]/)){l=(l+5)}if(k.match(/\d+/)){l=(l+5)}if(k.match(/(.*[0-9].*[0-9].*[0-9])/)){l=(l+7)}if(k.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)){l=(l+5)}if(k.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){l=(l+7)}if(k.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){l=(l+2)}if(k.match(/([a-zA-Z])/)&&k.match(/([0-9])/)){l=(l+3)}if(k.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)){l=(l+3)}for(var h=0;h<g.common.length;h++){if(k.toLowerCase()==g.common[h]){l=-200}}return l};b.initialize(d,f,a)};ploopi.documents={};ploopi.documents.openfolder=function(b,a){ploopi.popup.show("",460,null,true,"ploopi_documents_openfolder_popup");ploopi.xhr.todiv("admin-light.php",b,"ploopi_documents_openfolder_popup")};ploopi.documents.openfile=function(b,a){ploopi.popup.show("",460,null,true,"ploopi_documents_openfile_popup");ploopi.xhr.todiv("admin-light.php",b,"ploopi_documents_openfile_popup")};ploopi.documents.deletefile=function(a,b){ploopi.xhr.todiv("admin-light.php",a,"ploopidocuments_"+b)};ploopi.documents.deletefolder=function(a,b){ploopi.xhr.todiv("admin-light.php",a,"ploopidocuments_"+b)};ploopi.documents.browser=function(b,d,a){if(typeof(a)=="undefined"){a=false}if(a){ploopi.xhr.ajaxloader("ploopidocuments_"+d);ploopi.xhr.todiv("admin-light.php",b,"ploopidocuments_"+d)}else{ploopi.innerHTML("ploopidocuments_"+d,ploopi.xhr.send("admin-light.php",b))}};ploopi.documents.validate=function(a){if(a.documentsfile_name){if(!ploopi.validatefield("Fichier",a.documentsfile_name,"string")){return false}}if(ploopi.validatefield("Libellé",a.documentsfile_label,"string")){return true}return false};ploopi.documents.selectfile=function(d,b,a){if(typeof(a)=="undefined"){a=600}ploopi.popup.show(ploopi.xhr.ajaxloader_content,a,b,"click","ploopi_documents_popup");ploopi.xhr.todiv("admin-light.php",d,"ploopi_documents_popup","get")};ploopi.documents.dropzoneupload=function(b){var a=this;a.params=null;a.progressbar=null;a.inputfile=null;a.updating=null;a.start=0;a.files=null;a.pe=null;a.init=function(d){a.params=d;jQuery("#"+a.params.dropzone).on("dragover",function(f){f.preventDefault();jQuery(this).addClass("dragover")});jQuery("#"+a.params.dropzone).on("dragleave",function(f){f.preventDefault();jQuery(this).removeClass("dragover")});jQuery("#"+a.params.dropzone).on("click",function(f){f.preventDefault();a.inputfile.focus();a.inputfile.click()});a.inputfile=jQuery('<input type="file" multiple="true" style="position:absolute;top:0;z-index:0;" />');a.inputfile.on("change",function(f){f.preventDefault();a.files=a.inputfile[0].files;a.refresh()});jQuery("#"+a.params.dropzone).on("drop",function(f){f.preventDefault();jQuery(this).removeClass("dragover");a.files=f.originalEvent.dataTransfer.files;a.refresh()})};a.refresh=function(){jQuery("#"+a.params.filelist).html("");for(var d=0;d<a.files.length;d++){jQuery("#"+a.params.filelist).append("<div>"+a.files[d].name+"</div>")}};a.init(b)};ploopi.event={};ploopi.event.dispatch_onchange=function(a){jQuery("#"+a).trigger("change")};ploopi.event.dispatch_onclick=function(a){jQuery("#"+a).trigger("click")};ploopi.popup={};ploopi.popup.nb=0;ploopi.popup.hooks=null;jQuery(function(){ploopi.popup.hooks=jQuery(".hook");if(!ploopi.popup.hooks.length){ploopi.popup.hooks=jQuery("body")}});ploopi.popup.show=function(h,m,b,f,a,o,n){var d;var l=false;if(!a){a="ploopi_popup"}if(!jQuery("#"+a).length){ploopi.popup.nb++;d=document.createElement("div");d.setAttribute("class","ploopi_popup");d.setAttribute("className","ploopi_popup");d.setAttribute("id",a);d.setAttribute("style","z-index:"+(10000+ploopi.popup.nb)+";");d.style.display="none";ploopi.popup.hooks[0].appendChild(d);l=true}d=jQuery("#"+a).eq(0);m=parseInt(m);if(!m){m=200}var k=0;var g=0;o=parseInt(o);n=parseInt(n);if(o){k=o}if(n){g=n}if(b){wd=jQuery(window);ph=jQuery(ploopi.popup.hooks[0]);if(b.pageX||b.pageY){k=b.pageX-ph.offset().left+ph.scrollLeft()+wd.scrollLeft();g=b.pageY-ph.offset().top+ph.scrollTop()+wd.scrollTop()}else{if(b.clientX||b.clientY){k=b.clientX-ph.scrollLeft()+wd.scrollLeft();g=b.clientY-ph.scrollTop()+wd.scrollTop()}}}else{switch(f){case false:break;default:case true:wd=jQuery(window);ph=jQuery(ploopi.popup.hooks[0]);if(!k){k=wd.width()/2-m/2+ph.scrollLeft()+wd.scrollLeft()}if(!g){g=ph.scrollTop()+wd.scrollTop()+20}break}}if(typeof(h)!="undefined"){d.html(h)}tmpleft=parseInt(k)+20;tmptop=parseInt(g);if(m>0){d.css({width:m})}else{m=parseInt(d.width())}if(b&&((20+m+parseInt(tmpleft))>parseInt(jQuery(window).width()))){tmpleft=parseInt(tmpleft)-m-40}d.css({left:tmpleft,top:tmptop});if(l){d.fadeIn()}};ploopi.popup.hide=function(a){if(!a){a="ploopi_popup"}if(jQuery("#"+a).length){jQuery("#"+a).eq(0).fadeOut("normal",function(){this.remove()})}};ploopi.popup.hideall=function(){var a=jQuery(".ploopi_popup");jQuery(".ploopi_popup").each(function(b,d){d.remove()})};ploopi.popup.move=function(h,g,d,b,a){var f;if(!h){h="ploopi_popup"}f=jQuery("#"+h).eq(0);posx=0;posy=0;d=parseInt(d);b=parseInt(b);if(d){posx=d}if(b){posy=b}if(g){if(g.pageX||g.pageY){posx=g.pageX;posy=g.pageY}else{if(g.clientX||g.clientY){posx=g.clientX+document.body.scrollLeft;posy=g.clientY+document.body.scrollTop}}}f.html(a);tmpleft=parseInt(posx)+20;tmptop=parseInt(posy);w=parseInt(f.offsetWidth);if(20+w+parseInt(tmpleft)>parseInt(document.body.offsetWidth)){tmpleft=parseInt(tmpleft)-w-40}f.css({left:tmpleft,top:tmptop})};ploopi.popup.ize=function(k,d,f,b,a){var g;if(jQuery("#"+k).length){g=jQuery("#"+k);g.attr("class","ploopi_popup");g.attr("className","ploopi_popup");g.attr("style","display:block;z-index:"+(10000+ploopi.popup.nb)+";");d=parseInt(d);if(!d){d=200}switch(f){case false:posx=parseInt(b);posy=parseInt(a);break;default:case true:var h=document.viewport.getScrollOffsets();posx=parseInt(document.viewport.getWidth()/2)-parseInt(d/2)+h.left;posy=parseInt(h.top)+20;break}g.css({left:posx,top:posy,width:d});jQuery(ploopi.popup.hooks[0]).append(g)}};ploopi.skin={};ploopi.skin.array_refresh=function(a,b,d,f){jQuery.ajax({type:"GET",url:"admin-light.php",data:{ploopi_env:_PLOOPI_ENV,ploopi_op:"ploopi_skin_array_refresh",array_id:a,array_orderby:b,array_page:d,ploopi_randomize:Math.random()},async:true,dataType:"html",contentType:"application/x-www-form-urlencoded"}).done(function(g){jQuery("#ploopi_explorer_main_"+a).html(g);if(f!=""){ploopi.execute_function(f,window,a,b,d)}})};ploopi.skin.array_renderupdate=function(a){var d=jQuery("#ploopi_explorer_values_inner_"+a)[0].offsetHeight>jQuery("#ploopi_explorer_values_outer_"+a)[0].offsetHeight;if(d){if(!jQuery("#ploopi_explorer_spacer_"+a).length){var f=jQuery("#ploopi_explorer_values_outer_"+a)[0].offsetWidth-jQuery("#ploopi_explorer_values_inner_"+a)[0].offsetWidth;jQuery("#ploopi_explorer_title_"+a).html('<div id="ploopi_explorer_spacer_'+a+"\" style='float:right;width:"+f+"px;'>&nbsp;</div>"+jQuery("#ploopi_explorer_title_"+a).html());var b=jQuery("#ploopi_explorer_main_"+a+" .ploopi_explorer_column");for(j=0;j<b.length;j++){if(b[j].style.right!=""){b[j].style.right=(parseInt(b[j].style.right,10)+f)+"px"}}}}else{if(jQuery("#ploopi_explorer_spacer_"+a).length){var f=jQuery("#ploopi_explorer_spacer_"+a).width();jQuery("#ploopi_explorer_spacer_"+a).remove();var b=jQuery("#ploopi_explorer_main_"+a+" .ploopi_explorer_column");for(j=0;j<b.length;j++){if(b[j].style.right!=""){b[j].style.right=(parseInt(b[j].style.right,10)-f)+"px";console.log(b[j].style.right)}}}}if(jQuery.browser=="msie"){var b=jQuery("#ploopi_explorer_main_"+a+" .ploopi_explorer_column");for(j=0;j<b.length;j++){b[j].style.height=jQuery("#ploopi_explorer_main_"+a)[0].offsetHeight+"px"}}};ploopi.skin.treeview_shownode=function(d,b,a){if(typeof(a)=="undefined"){a="admin-light.php"}elt=jQuery("#t"+d)[0];dest=jQuery("#n"+d)[0];treenode=jQuery("#treeview_node"+d)[0];treenode.className="treeview_node_loading";if(elt.src.indexOf("plus")!=-1){elt.src=elt.src.replace("plus","minus")}else{if(elt.src.indexOf("minus")!=-1){elt.src=elt.src.replace("minus","plus")}}if(dest){if(dest.style.display=="none"){if(dest.innerHTML.length<20){dest.innerHTML=ploopi.xhr.send(a,b)}dest.style.display="block";treenode.className="treeview_node"}else{dest.style.display="none";treenode.className="treeview_node"}}};ploopi.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";ploopi.base64_encode=function(d){var a="";var n,l,h;var m,k,g,f;var b=0;do{n=d.charCodeAt(b++);l=d.charCodeAt(b++);h=d.charCodeAt(b++);m=n>>2;k=((n&3)<<4)|(l>>4);g=((l&15)<<2)|(h>>6);f=h&63;if(isNaN(l)){g=f=64}else{if(isNaN(h)){f=64}}a=a+ploopi.keyStr.charAt(m)+ploopi.keyStr.charAt(k)+ploopi.keyStr.charAt(g)+ploopi.keyStr.charAt(f)}while(b<d.length);return a};ploopi.base64_decode=function(d){var a="";var n,l,h;var m,k,g,f;var b=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{m=ploopi.keyStr.indexOf(d.charAt(b++));k=ploopi.keyStr.indexOf(d.charAt(b++));g=ploopi.keyStr.indexOf(d.charAt(b++));f=ploopi.keyStr.indexOf(d.charAt(b++));n=(m<<2)|(k>>4);l=((k&15)<<4)|(g>>2);h=((g&3)<<6)|f;a=a+String.fromCharCode(n);if(g!=64){a=a+String.fromCharCode(l)}if(f!=64){a=a+String.fromCharCode(h)}}while(b<d.length);return a};ploopi.addslashes=function(a){a=String(a);a=a.replace(/\\/g,"\\\\");a=a.replace(/\'/g,"\\'");a=a.replace(/\"/g,'\\"');return(a)};ploopi.subscription={};ploopi.subscription.display=function(b,a){if(typeof(a)=="undefined"){a=""}ploopi.xhr.todiv("admin-light.php","ploopi_env="+_PLOOPI_ENV+"&ploopi_op=subscription&ploopi_subscription_id="+b+"&next="+a,"ploopi_subscription_"+b)};ploopi.subscription.checkaction=function(a,b){var d=(b==-1)?jQuery("#ploopi_subscription_unsubscribe")[0]:jQuery("#ploopi_subscription_action_"+b)[0];d.checked=!d.checked;if(b==-1&&d.checked){jQuery(".ploopi_subscription_action").each(function(f){this.checked=false})}if(b>-1&&jQuery("#ploopi_subscription_unsubscribe")[0]&&jQuery("#ploopi_subscription_unsubscribe")[0].checked){jQuery("#ploopi_subscription_unsubscribe")[0].checked=false}if(b==0&&d.checked){jQuery(".ploopi_subscription_action").each(function(f){this.checked=true})}if(b>0&&!d.checked&&jQuery("#ploopi_subscription_action_0")[0].checked){jQuery("#ploopi_subscription_action_0")[0].checked=false}};ploopi.tickets={};ploopi.tickets.create=function(b,d,h,n,k,a,m,l){var g="";if(typeof(n)!="undefined"&&n!=null){g+="&ploopi_tickets_object_label="+n}if(typeof(d)!="undefined"&&d!=null){g+="&ploopi_tickets_id_object="+d}if(typeof(h)!="undefined"&&h!=null){g+="&ploopi_tickets_id_record="+h}if(typeof(a)!="undefined"&&a!=null){g+="&ploopi_tickets_reload="+a}if(typeof(k)!="undefined"&&k!=null){g+="&ploopi_tickets_id_user="+k}if(typeof(m)=="undefined"||m==null){m=0}if(typeof(l)=="undefined"||l==null){l=0}ploopi.popup.show("",550,b,true,"system_popupticket",m,l);ploopi.xhr.ajaxloader("system_popupticket");var f=jQuery.ajax({type:"GET",url:"admin-light.php",data:"ploopi_env="+_PLOOPI_ENV+"&ploopi_op=tickets_new"+g,dataType:"html",contentType:"application/x-www-form-urlencoded"});f.done(function(p){var o=document.createElement("script");o.onload=function(){jQuery("#system_popupticket").html(p);CKEDITOR.replace("fck_ticket_message",{customConfig:_PLOOPI_BASEPATH+"/js/ckeditor/ck_config.js"})};o.src="./vendor/ckeditor/ckeditor/ckeditor.js";document.head.appendChild(o)})};ploopi.tickets.open=function(b,f){var d="";if(typeof(object_label)!="undefined"&&object_label!=null){d+="&ploopi_tickets_object_label="+object_label}if(typeof(id_object)!="undefined"&&id_object!=null){d+="&ploopi_tickets_id_object="+id_object}if(typeof(id_record)!="undefined"&&id_record!=null){d+="&ploopi_tickets_id_record="+id_record}if(typeof(reload)!="undefined"&&reload!=null){d+="&ploopi_tickets_reload="+reload}if(typeof(id_user)!="undefined"&&id_user!=null){d+="&ploopi_tickets_id_user="+id_user}if(typeof(x)=="undefined"||x==null){x=0}if(typeof(y)=="undefined"||y==null){y=0}ploopi.popup.show("",550,b,true,"system_popupticket",x,y);ploopi.xhr.ajaxloader("system_popupticket");var a=jQuery.ajax({type:"GET",url:"admin-light.php",data:f,dataType:"html",contentType:"application/x-www-form-urlencoded"});a.done(function(h){var g=document.createElement("script");g.onload=function(){jQuery("#system_popupticket").html(h);CKEDITOR.replace("fck_ticket_message",{customConfig:_PLOOPI_BASEPATH+"/js/ckeditor/ck_config.js"})};g.src="./vendor/ckeditor/ckeditor/ckeditor.js";document.head.appendChild(g)})};ploopi.tickets.refresh=function(k,g,d,b){var a=k;var f=false;if(typeof(d)=="undefined"){d=""}if(typeof(b)=="undefined"){b=""}(function h(){jQuery.get("index-quick.php?ploopi_op=tickets_getnum",function(p,q,o){console.log(p);console.log(o.getResponseHeader("Ploopi-Connected"));if(o.getResponseHeader("Ploopi-Connected")=="1"){var m=p.split(",");if(m.length==2){var l=parseInt(m[0],10);var n=parseInt(m[1],10);$("#tpl_ploopi.tickets.create").html(d+l+b);if(n>a&&!f){ploopi.tickets.alert();f=true}a=n}setTimeout(h,g*1000)}else{console.log("Not connected")}})})()};ploopi.tickets.select_users=function(f,g,b,a){var d=jQuery.ajax({type:"POST",url:"admin-light.php?"+f,data:{ploopi_ticket_userfilter:b,ploopi_ticket_typefilter:g,ploopi_env:_PLOOPI_ENV},dataType:"html",contentType:"application/x-www-form-urlencoded"});d.done(function(h){jQuery("#"+a).html(h)})};ploopi.tickets.alert=function(){ploopi.popup.show("",350,null,true,"popup_tickets_new_alert",0,200);ploopi.xhr.ajaxloader("popup_tickets_new_alert");ploopi.xhr.todiv("admin-light.php","ploopi_env="+_PLOOPI_ENV+"&ploopi_op=tickets_alert","popup_tickets_new_alert")};ploopi.tickets.selectusers_init=function(){jQuery("#ploopi_ticket_userfilter")[0].onkeyup=ploopi.tickets.selectusers_keypress;jQuery("#ploopi_ticket_userfilter")[0].onkeypress=ploopi.tickets.selectusers_keypress};ploopi.tickets.selectusers_prevent=function(a){if(window.event){window.event.returnValue=false}else{a.preventDefault()}};ploopi.tickets.selectusers_keypress=function(a){a=a||window.event;src=(a.srcElement)?a.srcElement:a.target;switch(a.keyCode){case 9:case 13:ploopi_tickets_selectusers_prevent(a);ploopi.event.dispatch_onclick("ploopi_ticket_search_btn");break;default:break}};function ploopi_ticket_validateTo(b,a){var d=true;var g=new String();var f=new RegExp("<FIELD_LABEL>","gi");if(a){field_value=a.value;d=(field_value.replace(/(^\s*)|(\s*$)/g,"").length>0)}else{d=false}if(!d){g=lstmsg[4];alert(g.replace(f,b))}return(d)}ploopi.openwin=function(f,b,g,d){var l=(screen.height-(g+60))/2;var k=(screen.width-b)/2;if(!d){d="ploopiwin"}var a=window.open(f,d,"top="+l+",left="+k+",width="+b+", height="+g+", status=no, menubar=no, toolbar=no, scrollbars=yes, resizable=yes, screenY=20, screenX=20");a.focus();return(a)};ploopi.confirmform=function(b,a){if(confirm(a)){b.submit()}};ploopi.confirmlink=function(b,a){if(confirm(a)){location.href=b}};ploopi.switchdisplay=function(a){e=jQuery("#"+a);if(e){e.css("display",e.css("display")=="none"?"block":"none")}};ploopi.getelem=function(elem,obj){if(typeof(obj)!="object"){obj=document}return(obj.getElementById)?obj.getElementById(elem):eval("document.all['"+ploopi.addslashes(elem)+"']")};ploopi.innerHTML=function(b,a){if(jQuery("#"+b).length){jQuery("#"+b).html(a)}};ploopi.checkbox_click=function(d,a){var b=jQuery("#"+a)[0];if(d.target==b){return}switch(b.type){case"radio":b.checked=true;break;default:b.checked=!b.checked;break}ploopi.event.dispatch_onchange("inputfield_id")};ploopi.execute_function=function(h,d){var a=Array.prototype.slice.call(arguments,2);var g=h.split(".");var f=g.pop();for(var b=0;b<g.length;b++){d=d[g[b]]}return d[f].apply(d,a)};ploopi.get_param=function(a){var f=window.location.search.substring(1);var d=f.split("&");for(var b=0;b<d.length;b++){var g=d[b].split("=");if(g[0]==a){return g[1]}}};ploopi.insertatcursor=function(f,d){if(document.selection){f.focus();sel=document.selection.createRange();sel.text=d}else{if(f.selectionStart||f.selectionStart=="0"){var b=f.selectionStart;var a=f.selectionEnd;f.value=f.value.substring(0,b)+d+f.value.substring(a,f.value.length)}else{f.value+=d}}};ploopi_insertatcursor=function(b,a){ploopi.insertatcursor(b,a)};ploopi.rgbcolor=function(k){this.ok=false;if(k.charAt(0)=="#"){k=k.substr(1,6)}k=k.replace(/ /g,"");k=k.toLowerCase();var a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",noir:"000000",blanchedalmond:"ffebcd",blue:"0000ff",bleu:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",gris:"808080",green:"008000",vert:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",rose:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rouge:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",blanc:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",jaune:"ffff00",yellowgreen:"9acd32"};for(var d in a){if(k==d){k=a[d]}}var l=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(m){return[parseInt(m[1]),parseInt(m[2]),parseInt(m[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(m){return[parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(m){return[parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16)]}}];for(var b=0;b<l.length;b++){var g=l[b].re;var f=l[b].process;var h=g.exec(k);if(h){channels=f(h);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var o=this.r.toString(16);var n=this.g.toString(16);var m=this.b.toString(16);if(o.length==1){o="0"+o}if(n.length==1){n="0"+n}if(m.length==1){m="0"+m}return"#"+o+n+m};this.getHelpXML=function(){var o=new Array();for(var q=0;q<l.length;q++){var n=l[q].example;for(var p=0;p<n.length;p++){o[o.length]=n[p]}}for(var v in a){o[o.length]=v}var r=document.createElement("ul");r.setAttribute("id","rgbcolor-examples");for(var q=0;q<o.length;q++){try{var s=document.createElement("li");var u=new ploopi.rgbcolor(o[q]);var z=document.createElement("div");z.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex();z.appendChild(document.createTextNode("test"));var m=document.createTextNode(" "+o[q]+" -> "+u.toRGB()+" -> "+u.toHex());s.appendChild(z);s.appendChild(m);r.appendChild(s)}catch(t){}}return r}};ploopi.validatefield=function(m,a,l){var k=true;var g;var h=0;var d=new String();var b=new RegExp("<FIELD_LABEL>","gi");if(a){field_value=a.value;m=m.replace(/(<([^>]+)>)/ig,"");if(l=="selected"){d=lstmsg[9];k=(a.selectedIndex>=0&&a.value!="")}if(l=="checked"){k=false;if(a.length==undefined){d=lstmsg[14];if(a.checked){k=true}}else{d=lstmsg[9];for(c=0;c<a.length;c++){if(a[c].checked){k=true}}}}if(l=="phone"||l=="emptyphone"){if(l=="emptyphone"&&field_value.length==0){k=true}else{k=(field_value.search(/^\+?(\([0-9 ]+\))?[0-9 ]+$/)!=-1)}if(!k){d=(l=="phone"&&field_value.length==0)?lstmsg[4]:lstmsg[11]}}if(l=="email"||l=="emptyemail"){if(l=="emptyemail"&&field_value.length==0){k=true}else{k=(field_value.search(/^[a-zA-Z0-9]{1}([a-zA-Z0-9._-])+@[a-zA-Z0-9]{1}([a-zA-Z0-9.-])+\.[a-zA-Z]{2,64}$/)!=-1)}if(!k){d=(l=="email"&&field_value.length==0)?lstmsg[4]:lstmsg[0]}}if(l=="url"||l=="emptyurl"){if(l=="emptyurl"&&field_value.length==0){k=true}else{k=(field_value.search(/^(((ht|f)tp(s?))\:\/\/)?(([a-zA-Z0-9]+([@\-\.]?[a-zA-Z0-9]+)*)(\:[a-zA-Z0-9\-\.]+)?@)?(www.|ftp.|[a-zA-Z]+.)?[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,})(\:[0-9]+)?\/?/g)!=-1)}if(!k){d=(l=="url"&&field_value.length==0)?lstmsg[4]:lstmsg[13]}}if(l=="color"){var f=new ploopi.rgbcolor(field_value);if(!f.ok){k=false;d=lstmsg[10]}}if(l=="string"){k=(field_value.replace(/(^\s*)|(\s*$)/g,"").length>0);if(!k){d=lstmsg[4]}}if(l=="int"||l=="emptyint"){if(l=="emptyint"&&field_value.length==0){k=true}else{k=(field_value.search(/^(\-?[0-9]+)$/)!=-1)}if(!k){d=(l=="int"&&field_value.length==0)?lstmsg[4]:lstmsg[5]}}if(l=="float"||l=="emptyfloat"){if(l=="emptyfloat"&&field_value.length==0){k=true}else{k=(field_value.search(/^(\-?((([0-9]+(\.)?)|([0-9]*\.[0-9]+))))$/)!=-1)}if(!k){d=(l=="float"&&field_value.length==0)?lstmsg[4]:lstmsg[6]}}if(l=="date"||l=="emptydate"){if(l=="emptydate"&&field_value.length==0){k=true}else{k=false;if(l=="date"&&field_value.length>0){k=true}}if(!k){d=(l=="date"&&field_value.length==0)?lstmsg[4]:""}}if(l=="time"||l=="emptytime"){if(l=="emptytime"&&field_value.length==0){k=true}else{k=(field_value.search(/^(0[0-9]|1[0-9]|2[0-4]):[0-5][0-9](:[0-5][0-9])?$/)!=-1)}if(!k){d=(l=="time"&&field_value.length==0)?lstmsg[4]:lstmsg[8]}}if(l=="captcha"){k=false;if(arguments.length>=4&&field_value.length>0){new Ajax.Request(arguments[3],{asynchronous:false,methode:"get",parameters:"value="+field_value,onSuccess:function(n){k=(n.responseText==1)?true:false}})}if((!k)&&arguments.length>=6&&jQuery(arguments[4])&&arguments[5].length>0){jQuery(arguments[4]).src=arguments[5]+"&random="+Math.random()}if(!k){d=(l=="captcha"&&field_value.length==0)?lstmsg[4]:lstmsg[12]}}}else{k=false}if(!k){alert(d.replace(b,m));if(l!="checked"){jQuery(a).addClass("ploopi_validate_error");a.focus()}}return(k)};ploopi.validatereset=function(a){jQuery(a).find("input,textarea,select").each(function(b){jQuery(b).removeClass("ploopi_validate_error")})};ploopi.xhr={};ploopi.xhr.ajaxloader_content='<div style="text-align:center;padding:40px 10px;"><img src="./img/ajax-loader.png"></div>';ploopi.xhr.ajaxloader=function(a){if(jQuery("#"+a).length){jQuery("#"+a).html(ploopi.xhr.ajaxloader_content)}else{return ploopi.xhr.ajaxloader_content}};ploopi.xhr.send=function(d,h,b,g,k){if(typeof(b)=="undefined"){b=false}if(typeof(g)=="undefined"){g=false}if(typeof(k)=="undefined"){k="GET"}var a="";var f=jQuery.ajax({type:k,url:d,data:h,async:b,dataType:g?"xml":"html",contentType:"application/x-www-form-urlencoded"});f.done(function(l){a=l});if(!b){return a}};ploopi.xhr.todiv=function(a,d,g,f){if(typeof(f)=="undefined"){f="GET"}var b=jQuery.ajax({type:f,url:a,data:d,dataType:"html",contentType:"application/x-www-form-urlencoded"});b.done(function(h){jQuery("#"+g).html(h)})};ploopi.xhr.tocb=function(a,f,k,g,d,h){if(typeof(d)=="undefined"){d=false}if(typeof(h)=="undefined"){h="GET"}var b=jQuery.ajax({type:h,url:a,data:f,dataType:d?"xml":"html",contentType:"application/x-www-form-urlencoded"});b.done(function(l){k(l,g)})};ploopi.xhr.topopup=function(b,f,h,a,d,g){if(typeof(g)=="undefined"){g="GET"}ploopi.popup.show(ploopi.xhr.ajaxloader_content,b,f,"click",h,null,null);ploopi.xhr.todiv(a,d,h,g)};ploopi.xhr.submit=function(a,f,d){var b=true;if(typeof(d)=="function"){b=d(a)}query=jQuery(a).serialize();query+=(query==""?"":"&")+"ploopi_xhr=1";if(b){ploopi.xhr.todiv(a.action,query,f,"POST")}};