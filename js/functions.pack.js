ploopi_window_onload_functions=new Array();ploopi_window_onunload_functions=new Array();function ploopi_window_onload_stock(A){ploopi_window_onload_functions[ploopi_window_onload_functions.length]=A}function ploopi_window_onload_launch(){window.onload=function(){for(var A=0;A<ploopi_window_onload_functions.length;A++){ploopi_window_onload_functions[A]()}}}function ploopi_window_onunload_stock(A){ploopi_window_onunload_functions[ploopi_window_onunload_functions.length]=A}function ploopi_window_onunload_launch(){window.onunload=function(){for(var A=0;A<ploopi_window_onunload_functions.length;A++){ploopi_window_onunload_functions[A]()}}}function ploopi_openwin(D,B,E,C){var G=(screen.height-(E+60))/2;var F=(screen.width-B)/2;if(!C){C="ploopiwin"}var A=window.open(D,C,"top="+G+",left="+F+",width="+B+", height="+E+", status=no, menubar=no, toolbar=no, scrollbars=yes, resizable=yes, screenY=20, screenX=20");A.focus();return(A)}function ploopi_confirmform(B,A){if(confirm(A)){B.submit()}}function ploopi_confirmlink(B,A){if(confirm(A)){location.href=B}}function ploopi_switchstyle(B,A){B.style.filter="alpha(opacity:"+(A)+")";B.style.MozOpacity=A/100}function ploopi_switchdisplay(A){e=$(A);if(e){e.style.display=(e.style.display=="none")?"block":"none"}}function ploopi_checkbox_click(B,A){src=(B.srcElement)?B.srcElement:B.target;if(typeof (src.id)=="undefined"||src.id!=A){if(Prototype.Browser.IE){switch($(A).type){case"radio":$(A).checked=true;break;default:$(A).checked=!$(A).checked;break}$(A).fireEvent("onchange")}else{var B=document.createEvent("MouseEvents");B.initEvent("click",false,false);$(A).dispatchEvent(B)}}}function ploopi_rgbcolor(G){this.ok=false;if(G.charAt(0)=="#"){G=G.substr(1,6)}G=G.replace(/ /g,"");G=G.toLowerCase();var A={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",noir:"000000",blanchedalmond:"ffebcd",blue:"0000ff",bleu:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",gris:"808080",green:"008000",vert:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",rose:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rouge:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",blanc:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",jaune:"ffff00",yellowgreen:"9acd32"};for(var C in A){if(G==C){G=A[C]}}var H=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(I){return[parseInt(I[1]),parseInt(I[2]),parseInt(I[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(I){return[parseInt(I[1],16),parseInt(I[2],16),parseInt(I[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(I){return[parseInt(I[1]+I[1],16),parseInt(I[2]+I[2],16),parseInt(I[3]+I[3],16)]}}];for(var B=0;B<H.length;B++){var E=H[B].re;var D=H[B].process;var F=E.exec(G);if(F){channels=D(F);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var K=this.r.toString(16);var J=this.g.toString(16);var I=this.b.toString(16);if(K.length==1){K="0"+K}if(J.length==1){J="0"+J}if(I.length==1){I="0"+I}return"#"+K+J+I};this.getHelpXML=function(){var K=new Array();for(var M=0;M<H.length;M++){var J=H[M].example;for(var L=0;L<J.length;L++){K[K.length]=J[L]}}for(var R in A){K[K.length]=R}var N=document.createElement("ul");N.setAttribute("id","rgbcolor-examples");for(var M=0;M<K.length;M++){try{var O=document.createElement("li");var Q=new ploopi_rgbcolor(K[M]);var S=document.createElement("div");S.style.cssText="margin: 3px; border: 1px solid black; background:"+Q.toHex()+"; color:"+Q.toHex();S.appendChild(document.createTextNode("test"));var I=document.createTextNode(" "+K[M]+" -> "+Q.toRGB()+" -> "+Q.toHex());O.appendChild(S);O.appendChild(I);N.appendChild(O)}catch(P){}}return N}}function ploopi_validatefield(field_label,field_object,field_type){var ok=true;var i;var nbpoint=0;var msg=new String();var reg=new RegExp("<FIELD_LABEL>","gi");if(field_object){field_value=field_object.value;if(field_type=="selected"){msg=lstmsg[9];ok=(field_object.selectedIndex>0&&field_object.value!="")}if(field_type=="checked"){msg=lstmsg[9];ok=false;for(c=0;c<field_object.length;c++){if(field_object[c].checked){ok=true}}}if(field_type=="email"){var email=field_value;var aroba=email.indexOf("@");if(aroba==-1){ok=false;msg=lstmsg[0]}if(ok){var point=email.indexOf(".",aroba);if((point==-1)||(point==(aroba+1))){ok=false;msg=lstmsg[1]}}if(ok){var point=email.lastIndexOf(".");if((point+1)==email.length){ok=false;msg=lstmsg[2]}}if(ok){point=email.indexOf("..");if(point!=-1){ok=false;msg=lstmsg[3]}}}if(field_type=="emptyemail"){if(field_value.length!=0){var email=field_value;var aroba=email.indexOf("@");if(aroba==-1){ok=false;msg=lstmsg[0]}if(ok){var point=email.indexOf(".",aroba);if((point==-1)||(point==(aroba+1))){ok=false;msg=lstmsg[1]}}if(ok){var point=email.lastIndexOf(".");if((point+1)==email.length){ok=false;msg=lstmsg[2]}}if(ok){point=email.indexOf("..");if(point!=-1){ok=false;msg=lstmsg[3]}}}}if(field_type=="color"){var color=new ploopi_rgbcolor(field_value);if(!color.ok){ok=false;msg=lstmsg[10];alert("ici")}}if(field_type=="string"){if(field_value.replace(/(^\s*)|(\s*$)/g,"").length==0){ok=false;msg=lstmsg[4]}}if(field_type=="int"){if(field_value.length==0||field_value.length>12){ok=false}for(i=0;i<field_value.length;i++){if(field_value.charAt(i)<"0"||field_value.charAt(i)>"9"){ok=false}}if(!ok){msg=lstmsg[5]}}if(field_type=="emptyint"){if(field_value.length>12){ok=false}for(i=0;i<field_value.length;i++){if(field_value.charAt(i)<"0"||field_value.charAt(i)>"9"){ok=false}}if(!ok){msg=lstmsg[5]}}if(field_type=="float"){if(field_value.length==0){ok=false}for(i=0;i<field_value.length;i++){if(field_value.charAt(i)=="."||field_value.charAt(i)==","){nbpoint++}else{if(field_value.charAt(i)<"0"||field_value.charAt(i)>"9"){ok=false}}}if(nbpoint>1){ok=false}if(!ok){msg=lstmsg[6]}}if(field_type=="emptyfloat"){for(i=0;i<field_value.length;i++){if(field_value.charAt(i)=="."){nbpoint++}if(field_value.charAt(i)<"0"||field_value.charAt(i)>"9"){ok=false}}if(nbpoint>1){ok=false}if(!ok){msg=lstmsg[6]}}if(field_type=="date"){var thedate=field_value.split("/");if(thedate.length!=3||isNaN(parseInt(thedate[0]))||isNaN(parseInt(thedate[1]))||isNaN(parseInt(thedate[2]))){thedate=field_value.split("-")}if(thedate.length!=3||isNaN(parseInt(thedate[0]))||isNaN(parseInt(thedate[1]))||isNaN(parseInt(thedate[2]))){thedate=field_value.split(":")}if(thedate.length!=3||isNaN(parseInt(thedate[0]))||isNaN(parseInt(thedate[1]))||isNaN(parseInt(thedate[2]))){ok=false}if(ok){var datetotest=new Date(eval(thedate[2]),eval(thedate[1])-1,eval(thedate[0]));var year=datetotest.getYear();if((Math.abs(year)+"").length<4){year=year+1900}ok=((datetotest.getDate()==eval(thedate[0]))&&(datetotest.getMonth()==eval(thedate[1])-1)&&(year==eval(thedate[2])))}if(!ok){msg=lstmsg[7]}}if(field_type=="time"){if(field_value.length!=5){ok=false}else{h=field_value.substring(0,2);m=field_value.substring(3,5);if(parseInt(h)<0||parseInt(h)>23){ok=false}if(parseInt(m)<0||parseInt(m)>59){ok=false}madate=new Date(1,1,2000,h,m);if(madate=="NaN"||field_value.charAt(2)!=":"){ok=false}}if(!ok){msg=lstmsg[8]}}if(field_type=="emptydate"){if(field_value.length!=0){var thedate=field_value.split("/");if(thedate.length!=3||isNaN(parseInt(thedate[0]))||isNaN(parseInt(thedate[1]))||isNaN(parseInt(thedate[2]))){thedate=field_value.split("-")}if(thedate.length!=3||isNaN(parseInt(thedate[0]))||isNaN(parseInt(thedate[1]))||isNaN(parseInt(thedate[2]))){thedate=field_value.split(":")}if(thedate.length!=3||isNaN(parseInt(thedate[0]))||isNaN(parseInt(thedate[1]))||isNaN(parseInt(thedate[2]))){ok=false}if(ok){var datetotest=new Date(eval(thedate[2]),eval(thedate[1])-1,eval(thedate[0]));var year=datetotest.getYear();if((Math.abs(year)+"").length<4){year=year+1900}ok=((datetotest.getDate()==eval(thedate[0]))&&(datetotest.getMonth()==eval(thedate[1])-1)&&(year==eval(thedate[2])))}if(!ok){msg=lstmsg[7]}}}if(field_type=="emptytime"){if(field_value.length!=0){if(field_value.length!=5){ok=false}else{h=field_value.substring(0,2);m=field_value.substring(3,5);if(parseInt(h)<0||parseInt(h)>23){ok=false}if(parseInt(m)<0||parseInt(m)>59){ok=false}madate=new Date(1,1,2000,h,m);if(madate=="NaN"||field_value.charAt(2)!=":"){ok=false}}if(!ok){msg=lstmsg[8]}}}}else{ok=false}if(!ok){alert(msg.replace(reg,field_label));if(field_type!="checked"){field_object.style.background=error_bgcolor;field_object.focus()}}return(ok)}function ploopi_checkall(F,B,G,C){var A=F.elements.length;var E=new RegExp(B,"g");if(!C){C=false}for(var D=0;D<A;D++){var H=F.elements[D];if(C){if(H.id.match(E)){H.checked=G}}else{if(H.name.match(E)){H.checked=G}}}}function ploopi_addslashes(A){A=String(A);A=A.replace(/\\/g,"\\\\");A=A.replace(/\'/g,"\\'");A=A.replace(/\"/g,'\\"');return(A)}var ploopi_nbpopup=0;function ploopi_showpopup(popup_content,w,e,centered,id,pposx,pposy){var ploopi_popup;var active_effect=false;if(!id){id="ploopi_popup"}if(!$(id)){bodys=document.getElementsByTagName("body");ploopi_nbpopup++;ploopi_popup=document.createElement("div");ploopi_popup.setAttribute("class","ploopi_popup");ploopi_popup.setAttribute("className","ploopi_popup");ploopi_popup.setAttribute("id",id);ploopi_popup.setAttribute("style","z-index:"+(1000+ploopi_nbpopup)+";");ploopi_popup.style.display="none";bodys[0].appendChild(ploopi_popup);active_effect=true}else{ploopi_popup=$(id)}w=parseInt(w);if(!w){w=200}posx=0;posy=0;pposx=parseInt(pposx);pposy=parseInt(pposy);if(pposx){posx=pposx}if(pposy){posy=pposy}if(e){if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY}else{if(e.clientX||e.clientY){posx=e.clientX+document.body.scrollLeft;posy=e.clientY+document.body.scrollTop}}}else{switch(centered){case false:break;default:case true:var p_width=parseInt(document.body.offsetWidth);var p_left=parseInt(document.body.scrollLeft);var posx=(p_width/2)-(w/2)+p_left;break}}with(ploopi_popup.style){if(typeof (popup_content)!="undefined"){ploopi_innerHTML(id,popup_content)}tmpleft=parseInt(posx)+20;tmptop=parseInt(posy);if(w>0){width=w+"px"}else{w=parseInt(ploopi_popup.offsetWidth)}if(20+w+parseInt(tmpleft)>parseInt(document.body.offsetWidth)){tmpleft=parseInt(tmpleft)-w-40}left=tmpleft+"px";top=tmptop+"px"}if(active_effect){new Effect.Appear(id,{duration:0.4,from:0,to:1})}}function ploopi_movepopup(id,e,pposx,pposy,popup_content){var ploopi_popup;if(!id){id="ploopi_popup"}ploopi_popup=$(id);posx=0;posy=0;pposx=parseInt(pposx);pposy=parseInt(pposy);if(pposx){posx=pposx}if(pposy){posy=pposy}if(e){if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY}else{if(e.clientX||e.clientY){posx=e.clientX+document.body.scrollLeft;posy=e.clientY+document.body.scrollTop}}}with(ploopi_popup.style){ploopi_innerHTML(id,popup_content);tmpleft=parseInt(posx)+20;tmptop=parseInt(posy);w=parseInt(ploopi_popup.offsetWidth);if(20+w+parseInt(tmpleft)>parseInt(document.body.offsetWidth)){tmpleft=parseInt(tmpleft)-w-40}left=tmpleft+"px";top=tmptop+"px"}}function ploopi_hidepopup(A){if(!A){A="ploopi_popup"}if($(A)){new Effect.Fade(A,{duration:0.3,afterFinish:function(){var B=document.getElementsByTagName("body");B[0].removeChild($(A))}})}}function ploopi_hideallpopups(){var C=document.getElementsByClassName("ploopi_popup");var B=document.getElementsByTagName("body");var A=C.length;for(var D=0;D<A;D++){B[0].removeChild(C[D])}}function ploopi_getelem(elem,doc){if(!doc){doc=document}return(doc.getElementById)?doc.getElementById(elem):eval("document.all['"+ploopi_addslashes(elem)+"']")}function ploopi_gethttpobject(callback){var xmlhttp=false;
/*@cc_on
    @if (@_jscript_version >= 5)
    try
    {
        xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
    }
    catch (e)
    {
        try
        {
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch (E)
        {
            xmlhttp = false;
        }
    }
    @else
    xmlhttp = false;
    @end @*/
if(!xmlhttp&&typeof XMLHttpRequest!="undefined"){try{xmlhttp=new XMLHttpRequest()}catch(e){xmlhttp=false}}return xmlhttp}function ploopi_sendxmldata(E,B,D,C,A){if(!C){return false}if(E=="GET"){if(D=="null"){C.open("GET",B,A);C.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=ISO-8859-15")}else{C.open("GET",B+"?"+D,A);C.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=ISO-8859-15")}C.send(null)}else{if(E=="POST"){C.open("POST",B,A);C.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=ISO-8859-15");C.send(D)}}return true}function ploopi_xmlhttprequest(B,E,A,D){if(isNaN(A)){A=false}if(isNaN(D)){D=false}var C=ploopi_gethttpobject();ploopi_sendxmldata("GET",B,E,C,A);if(!A){if(D){return(C.responseXML)}else{return(C.responseText)}}}function ploopi_xmlhttprequest_tofunction(A,D,F,E,C){var B=ploopi_gethttpobject();if(!C){C=false}if(B){B.onreadystatechange=function(){if(B.readyState==4){if(B.status==200){if(C){F(B.responseXML,E)}else{F(B.responseText,E)}}}}}return !ploopi_sendxmldata("GET",A,D,B,true)}function ploopi_xmlhttprequest_todiv(C,E,B){var D=ploopi_gethttpobject();var A;if(D){A=ploopi_xmlhttprequest_todiv.arguments;D.onreadystatechange=function(){if(D.readyState==4){if(D.status==200){var G=new Array();var F=D.responseText;if(B==""){G[0]=F}else{G=F.split(B)}for(i=0;i<A.length-3;i++){if(G[i]){ploopi_innerHTML(A[i+3],G[i])}else{ploopi_innerHTML(A[i+3],"")}}}}}}return !ploopi_sendxmldata("GET",C,E,D,true)}var ploopi_ajaxloader_content='<div style="text-align:center;padding:40px 10px;"><img src="./img/ajax-loader.gif"></div>';function ploopi_ajaxloader(A){if(A&&$(A)){$(A).innerHTML=ploopi_ajaxloader_content}else{return ajaxloader}}function ploopi_innerHTML(B,A){if($(B)){$(B).innerHTML=A;$(B).innerHTML.evalScripts()}}function ploopi_calendar_open(A,B){ploopi_showpopup(ploopi_xmlhttprequest("index-light.php","ploopi_op=calendar_open&selected_date="+$(A).value+"&inputfield_id="+A),164,B,"click","ploopi_popup_calendar")}function ploopi_calendar_dispatchevent(A){if(Prototype.Browser.IE){$(A).fireEvent("onChange")}else{var B=document.createEvent("HTMLEvents");B.initEvent("change",false,false);$(A).dispatchEvent(B)}}var rgb,hsv;function colorpicker_hex2rgb(B,E){if(E==undefined){E=null}if(B.substr(0,1)=="#"){B=B.substr(1)}var D;var C;var A;if(B.length==3){D=B.substr(0,1);D+=D;C=B.substr(1,1);C+=C;A=B.substr(2,1);A+=A}else{if(B.length==6){D=B.substr(0,2);C=B.substr(2,2);A=B.substr(4,2)}else{return E}}D=parseInt(D,16);C=parseInt(C,16);A=parseInt(A,16);if(isNaN(D)||isNaN(C)||isNaN(A)){return E}else{return{r:D/255,g:C/255,b:A/255}}}function colorpicker_rgb2hex(C,B,A,D){C=Math.round(C*255);B=Math.round(B*255);A=Math.round(A*255);if(D==undefined){D=true}C=C.toString(16);if(C.length==1){C="0"+C}B=B.toString(16);if(B.length==1){B="0"+B}A=A.toString(16);if(A.length==1){A="0"+A}return((D?"#":"")+C+B+A).toUpperCase()}function colorpicker_hsv2rgb(G,F,I){var C;var D;var J;if(I==0){C=0;D=0;J=0}else{var E=Math.floor(G*6);var H=(G*6)-E;var B=I*(1-F);var A=I*(1-(F*H));var K=I*(1-(F*(1-H)));switch(E){case 1:C=A;D=I;J=B;break;case 2:C=B;D=I;J=K;break;case 3:C=B;D=A;J=I;break;case 4:C=K;D=B;J=I;break;case 5:C=I;D=B;J=A;break;case 6:case 0:C=I;D=K;J=B;break}}return{r:C,g:D,b:J}}function colorpicker_rgb2hsv(A,B,H){var F=Math.max(Math.max(A,B),H);var C=Math.min(Math.min(A,B),H);var E;var D;var G=F;if(C==F){E=0;D=0}else{var I=(F-C);D=I/F;if(A==F){E=(B-H)/I}else{if(B==F){E=2+((H-A)/I)}else{E=4+((A-B)/I)}}E/=6;if(E<0){E+=1}if(E>1){E-=1}}return{h:E,s:D,v:G}}function colorpicker_initelements(){x=(hsv.v*199)-5;if(x<-5){x=-5}if(x>194){x=194}$("colorpicker_crosshairs").style.left=x.toString()+"px";y=((1-hsv.s)*199)-5;if(y<-5){y=-5}if(y>194){y=194}$("colorpicker_crosshairs").style.top=y.toString()+"px";x=(hsv.h*199)-5;if(x<-5){x=-5}if(x>194){x=194}$("colorpicker_position").style.top=x.toString()+"px"}function colorpicker_colorchanged(){var B=colorpicker_rgb2hex(rgb.r,rgb.g,rgb.b);var C=colorpicker_hsv2rgb(hsv.h,1,1);var A=colorpicker_rgb2hex(C.r,C.g,C.b);$("colorpicker_selectedcolor").style.background=B;$("colorpicker_inputcolor").value=B;$("colorpicker_sv").style.background=A}function colorpicker_rgbchanged(){hsv=colorpicker_rgb2hsv(rgb.r,rgb.g,rgb.b);colorpicker_colorchanged()}function colorpicker_hsvchanged(){rgb=colorpicker_hsv2rgb(hsv.h,hsv.s,hsv.v);colorpicker_colorchanged()}function colorpicker_pagecoords(C){var A=C.offsetLeft;var D=C.offsetTop;var B=C.offsetParent;while(B!=null){A+=B.offsetLeft;D+=B.offsetTop;B=B.offsetParent}return{x:A,y:D}}function colorpicker_fixcoords(B,A,D){var C=colorpicker_pagecoords(B);A=(A-C.x)+document.documentElement.scrollLeft;D=(D-C.y)+document.documentElement.scrollTop;if(A<0){A=0}if(D<0){D=0}if(A>B.offsetWidth-1){A=B.offsetWidth-1}if(D>B.offsetHeight-1){D=B.offsetHeight-1}return{x:A,y:D}}function colorpicker_onmousedown(A){A=A||window.event;src=(A.srcElement)?A.srcElement:A.target;coords=colorpicker_fixcoords(src,A.clientX,A.clientY);if(src.id=="colorpicker_sv"){colorpicker_placeelement("colorpicker_crosshairs",coords.x,coords.y)}else{if(src.id=="colorpicker_crosshairs"){x=parseInt($("colorpicker_crosshairs").style.left)+coords.x;y=parseInt($("colorpicker_crosshairs").style.top)+coords.y;colorpicker_placeelement("colorpicker_crosshairs",x,y)}else{if(src.id=="colorpicker_h"){colorpicker_placeelement("colorpicker_position",0,coords.y)}else{if(src.id=="colorpicker_position"){y=parseInt($("colorpicker_position").style.top)+coords.y;colorpicker_placeelement("colorpicker_position",0,y)}}}}}function colorpicker_placeelement(B,A,C){if(A<0){A=0}if(A>199){A=199}if(C<0){C=0}if(C>199){C=199}if(B=="colorpicker_position"){$("colorpicker_position").style.top=(C-5)+"px";hsv.h=C/199}else{if(B=="colorpicker_crosshairs"){$("colorpicker_crosshairs").style.left=(A-5)+"px";$("colorpicker_crosshairs").style.top=(C-5)+"px";hsv.s=1-(C/199);hsv.v=(A/199)}}colorpicker_hsvchanged()}function colorpicker_input_onchange(){rgb=colorpicker_hex2rgb($("colorpicker_inputcolor").value,{r:0,g:0,b:0});colorpicker_rgbchanged();colorpicker_initelements()}function colorpicker_start(){$("colorpicker_sv").onmousedown=colorpicker_onmousedown;$("colorpicker_h").onmousedown=colorpicker_onmousedown;$("colorpicker_position").onmousedown=colorpicker_onmousedown;$("colorpicker_crosshairs").onmousedown=colorpicker_onmousedown;$("colorpicker_inputcolor").onchange=colorpicker_input_onchange;colorpicker_input_onchange()}function ploopi_colorpicker_open(A,B){ploopi_showpopup("","241",B,"click");data="ploopi_op=colorpicker_open&inputfield_id="+A+"&colorpicker_value="+escape($(A).value);colorpickerhtml=ploopi_xmlhttprequest("admin-light.php",data);$("ploopi_popup").innerHTML=colorpickerhtml;colorpicker_start()}function ploopi_documents_openfolder(C,B,A){ploopi_showpopup("",300,A,"click","ploopi_documents_openfolder_popup");ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=documents_openfolder&currentfolder="+C+"&documentsfolder_id="+B,"","ploopi_documents_openfolder_popup")}function ploopi_documents_openfile(C,B,A){ploopi_showpopup("",380,A,"click","ploopi_documents_openfile_popup");ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=documents_openfile&currentfolder="+C+"&documentsfile_id="+B,"","ploopi_documents_openfile_popup")}function ploopi_documents_deletefile(B,C,A){ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=documents_deletefile&currentfolder="+B+"&documentsfile_id="+A,"","ploopidocuments_"+C)}function ploopi_documents_deletefolder(B,C,A){ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=documents_deletefolder&currentfolder="+B+"&documentsfolder_id="+A,"","ploopidocuments_"+C)}function ploopi_documents_browser(D,F,E,C,A){if(!A){A=false}var B=(C)?"&orderby="+C:"";if(A){ploopi_ajaxloader("ploopidocuments_"+F);ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=documents_browser&mode="+E+"&currentfolder="+D+B,"","ploopidocuments_"+F)}else{ploopi_innerHTML("ploopidocuments_"+F,ploopi_xmlhttprequest("admin-light.php","ploopi_op=documents_browser&mode="+E+"&currentfolder="+D+B))}}function ploopi_documents_validate(A){if(A.documentsfile_name){if(!ploopi_validatefield("Fichier",A.documentsfile_name,"string")){return false}}else{if(!ploopi_validatefield("Fichier",A.documentsfile_file,"string")){return false}}if(ploopi_validatefield("Libellé",A.documentsfile_label,"string")){return true}return false}function ploopi_documents_popup(D,C,F,A,B){var E=ploopi_base64_encode(F+"_"+D+"_"+ploopi_addslashes(C)+"_popup");ploopi_showpopup(""+ploopi_xmlhttprequest("admin-light.php","ploopi_op=documents_selectfile&id_object="+D+"&id_record="+C+"&documents_id="+E+"&destfield="+A)+"",600,B,"click","ploopi_documents_popup")}var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ploopi_base64_encode(C){var A="";var J,H,F;var I,G,E,D;var B=0;do{J=C.charCodeAt(B++);H=C.charCodeAt(B++);F=C.charCodeAt(B++);I=J>>2;G=((J&3)<<4)|(H>>4);E=((H&15)<<2)|(F>>6);D=F&63;if(isNaN(H)){E=D=64}else{if(isNaN(F)){D=64}}A=A+keyStr.charAt(I)+keyStr.charAt(G)+keyStr.charAt(E)+keyStr.charAt(D)}while(B<C.length);return A}function ploopi_base64_decode(C){var A="";var J,H,F;var I,G,E,D;var B=0;C=C.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{I=keyStr.indexOf(C.charAt(B++));G=keyStr.indexOf(C.charAt(B++));E=keyStr.indexOf(C.charAt(B++));D=keyStr.indexOf(C.charAt(B++));J=(I<<2)|(G>>4);H=((G&15)<<4)|(E>>2);F=((E&3)<<6)|D;A=A+String.fromCharCode(J);if(E!=64){A=A+String.fromCharCode(H)}if(D!=64){A=A+String.fromCharCode(F)}}while(B<C.length);return A}function ploopi_subscription(B,A){if(typeof (A)=="undefined"){A=""}ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=subscription&ploopi_subscription_id="+B+"&next="+A,"","ploopi_subscription_"+B)}function ploopi_subscription_checkaction(A,B){var C=(B==-1)?$("ploopi_subscription_unsubscribe"):$("ploopi_subscription_action_"+B);C.checked=!C.checked;if(B==-1&&C.checked){ploopi_checkall($("ploopi_form_subscription_"+A),"ploopi_subscription_action_",false,true)}if(B>-1&&$("ploopi_subscription_unsubscribe")&&$("ploopi_subscription_unsubscribe").checked){$("ploopi_subscription_unsubscribe").checked=false}if(B==0&&C.checked){ploopi_checkall($("ploopi_form_subscription_"+A),"ploopi_subscription_action_",true,true)}if(B>0&&!C.checked&&$("ploopi_subscription_action_0").checked){$("ploopi_subscription_action_0").checked=false}}function ploopi_annotation(A){ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=annotation&id_annotation="+A,"","ploopiannotation_"+A)}var tag_timer;var tag_search;var tag_results=new Array();var tag_last_array=new Array();var tag_new_array=new Array();var tag_lastedit="";var tag_modified=-1;function ploopi_annotation_tag_init(A){$("ploopi_annotationtags_"+A).onkeyup=ploopi_annotation_tag_keyup;$("ploopi_annotationtags_"+A).onkeypress=ploopi_annotation_tag_keypress}function ploopi_annotation_tag_search(B,A){clearTimeout(tag_timer);tag_search=A;tag_timer=setTimeout("ploopi_annotation_tag_searchtimeout('"+B+"')",100)}function ploopi_annotation_tag_searchtimeout(A){list_tags=tag_search.split(" ");if(list_tags.length>0){ploopi_xmlhttprequest_tofunction("index-quick.php","ploopi_op=annotation_searchtags&tag="+list_tags[list_tags.length-1],ploopi_annotation_tag_display,A)}}function ploopi_annotation_tag_display(A,B){if(A!=""){tag_results=new Array();splited_result=A.split("|");tagstoprint="";for(i=0;i<splited_result.length;i++){detail=splited_result[i].split(";");if(tagstoprint!=""){tagstoprint+=" "}if(i==0){tagstoprint+="<b>"}tagstoprint+="<a href=\"javascript:ploopi_annotation_tag_complete('"+B+"',"+i+')">'+detail[0]+"</a> ("+detail[1]+")";if(i==0){tagstoprint+="</b>"}tag_results[i]=detail[0]}$("tagsfound_"+B).innerHTML=tagstoprint}else{$("tagsfound_"+B).innerHTML="";tag_results=new Array()}}function ploopi_annotation_tag_prevent(A){if(window.event){window.event.returnValue=false}else{A.preventDefault()}}function ploopi_annotation_tag_keypress(A){A=A||window.event;src=(A.srcElement)?A.srcElement:A.target;switch(A.keyCode){case 38:case 40:prevent(A);break;case 9:ploopi_annotation_tag_prevent(A);break;case 13:ploopi_annotation_tag_prevent(A);break;default:tag_lastedit=$(src.id).value;break}}function ploopi_annotation_tag_keyup(A){A=A||window.event;src=(A.srcElement)?A.srcElement:A.target;idrecord=src.id.split("_")[2];switch(A.keyCode){case 38:case 40:prevent(A);break;case 9:ploopi_annotation_tag_complete(idrecord);ploopi_annotation_tag_prevent(A);break;case 13:ploopi_annotation_tag_complete(idrecord);ploopi_annotation_tag_prevent(A);break;case 35:case 36:case 39:case 37:break;default:tag_last_array=new Array();tag_new_array=new Array();tag_last_array=tag_lastedit.split(" ");tag_new_array=$(src.id).value.split(" ");tag_modified=-1;for(i=0;i<tag_new_array.length;i++){if(tag_new_array[i]!=tag_last_array[i]){if(tag_modified==-1){tag_modified=i}else{tag_modified=-2}}}if(tag_modified>=0){ploopi_annotation_tag_search(idrecord,tag_new_array[tag_modified])}break}}function ploopi_annotation_tag_complete(B,A){if(!(A>=0)){A=0}if(tag_results[A]){tag_new_array[tag_modified]=tag_results[A];taglist="";for(i=0;i<tag_new_array.length;i++){if(taglist!=""){taglist+=" "}taglist+=tag_new_array[i]}$("ploopi_annotationtags_"+B).value=taglist.replace(/(^\s*)|(\s*$)/g,"")+" ";$("tagsfound_"+B).innerHTML=""}tag_results=new Array()}function ploopi_annotation_delete(A,B){if(confirm("Êtes vous certain de vouloir supprimer cette annotation ?")){ploopi_xmlhttprequest("index-quick.php","ploopi_op=annotation_delete&ploopi_annotation_id="+B)}ploopi_annotation(A)}function ploopi_annotation_validate(A){if(ploopi_validatefield("Titre",A.ploopi_annotationtags,"string")){return true}return false}function ploopi_skin_array_renderupdate(A){greater=$("ploopi_explorer_values_inner_"+A).offsetHeight>$("ploopi_explorer_values_outer_"+A).offsetHeight;if(greater){$("ploopi_explorer_title_"+A).innerHTML="<div style='float:right;width:16px;'>&nbsp;</div>"+$("ploopi_explorer_title_"+A).innerHTML;columns=$("ploopi_explorer_main_"+A).getElementsByClassName("ploopi_explorer_column");for(j=0;j<columns.length;j++){if(columns[j].style.right!=""){columns[j].style.right=(parseInt(columns[j].style.right)+16)+"px"}}}if(Prototype.Browser.IE){columns=$("ploopi_explorer_main_"+A).getElementsByClassName("ploopi_explorer_column");for(j=0;j<columns.length;j++){columns[j].style.height=$("ploopi_explorer_main_"+A).offsetHeight+"px"}}}function ploopi_tickets_new(D,F,C,A,B){var E="";if(A){E+="&ploopi_tickets_object_label="+A}if(F){E+="&ploopi_tickets_id_object="+F}if(C){E+="&ploopi_tickets_id_record="+C}if(B){E+="&ploopi_tickets_reload="+B}ploopi_showpopup("",550,D,"click","system_popupticket");ploopi_ajaxloader("system_popupticket");ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=tickets_new"+E,"","system_popupticket")}function ploopi_tickets_refresh(F,E,C,B){var A=F;var D=false;if(typeof (C)=="undefined"){C=""}if(typeof (B)=="undefined"){B=""}new PeriodicalExecuter(function(G){new Ajax.Request("index-quick.php?ploopi_op=tickets_getnum",{method:"get",encoding:"iso-8859-15",onSuccess:function(K){var I=K.responseText.split(",");if(I.length==2){var H=parseInt(I[0],10);var J=parseInt(I[1],10);$("tpl_ploopi_tickets_new").innerHTML=C+H+B;if(J>A&&!D){ploopi_tickets_alert();D=true}A=J}}})},E)}function ploopi_tickets_alert(){ploopi_showpopup("",350,null,true,"popup_tickets_new_alert",0,200);ploopi_ajaxloader("popup_tickets_new_alert");ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=tickets_alert","","popup_tickets_new_alert")}function ploopi_skin_array_refresh(A,B){ploopi_xmlhttprequest_todiv("admin-light.php","ploopi_op=ploopi_skin_array_refresh&array_id="+A+"&array_orderby="+B,"","ploopi_explorer_main_"+A)}ploopi_window_onload_launch();ploopi_window_onunload_launch();